<!DOCTYPE html>
<html lang="de">
<head>
		<meta charset="utf-8" />
		<title></title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

		<script src="/socket.io/socket.io.js"></script>
		<script>
		//Hier muss Anpassung für Hostname
		  //var socket = io.connect('http://localhost:5885');
		  var socket = io.connect('http://' + location.hostname + ':5885');
		  socket.on('handshake', function (data) {
			console.log(data);
			socket.emit('request', { my: 'data' });
			
			socket.on('response', function (data) {
				console.log(data);	
			});
		  });

		</script>

		<script type="text/javascript">

			$(document).ready(function() {
				$("#cam").attr("src","http://" + location.hostname + ":5885/uploads/529f97fa6ff48dc0a0c2e646/xxx.jpg");
			});
		


			function getCam(){
				//console.log("/cam/" + $("#von").val() +"/" +$("#bis").val());

				$(document).ready(function () {


						$.ajax({
							url: "/cam/" + $("#von").val() +"/" +$("#bis").val(),
							data: null,
							datatype: "json",
							type: "GET",
							success: function(data) {
								//console.dir(data);

								//Checking Web worker Support
								if (typeof (Worker) !== "undefined") {
									//Creating Worker Object
									var worker = new Worker("worker.js");
									//Call Back Function for Success
									//worker.onmessage = workerResultReceiver;
									worker.onmessage = function workerResultReceiver(e) {
										//Updating UI With Result
										//console.log("everything is fine - " + e.data);
										$("#cam").attr("src", e.data);
								 	};
									//Call Back function if some error occurred
									//worker.onerror = workerErrorReceiver;    
									worker.onerror = function workerErrorReceiver(e) {
										console.log("there was a problem with the WebWorker within " + e);
								 	};
									//Posting Data to worker: Here We are passing Email ID
									worker.postMessage(data);

									/*function workerResultReceiver(e) {
										//Updating UI With Result
										//console.log("everything is fine - " + e.data);
										$("#cam").attr("src", e.data);
								 	}*/

								 	/*function workerErrorReceiver(e) {
										console.log("there was a problem with the WebWorker within " + e);
								 	}*/
							 	} else {
									alert("Sorry!!! Worker Not Supported in Your Browser");
								}
							}
					   	});					
		 		});
			}



			function clickToStore(){

				$.ajax({
						url: "/index.html",
						data: null,
						datatype: "json",
						type: "GET",
						success: function(data) {
							//console.dir(data);
					
							//$("#stream").html("<embed type=\"application/x-vlc-plugin\" pluginspage=\"http://www.videolan.org\" version=\"VideoLAN.VLCPlugin.2\"  width=\"640px\"  height=\"480px\" id=\"vlc\" loop=\"yes\" autoplay=\"yes\" target=\"rtsp://192.168.1.200:554/rtspjpeg480p\" />");
							$("#stream").html("<embed type=\"application/x-vlc-plugin\" pluginspage=\"http://www.videolan.org\" version=\"VideoLAN.VLCPlugin.2\"  width=\"640px\"  height=\"480px\" id=\"vlc\" loop=\"yes\" autoplay=\"yes\" target=\"rtsp://178.15.200.114:556/rtspjpeg480p\" />");
						}
				   });

				
			}

			function clickToFind(email){
				$.ajax({
							url: "/user/" + email,
							type: "GET",
							success: function(data) {
								console.dir(data);
							}					
					   });
							console.dir(location.hostname);
			}

		</script>
</head>
<body>
						<!-- Hier muss Anpassung für Hostname -->	
		<img id="cam" src="" alt="Cam1" /><br />
		<div id="stream"></div>
		
		<input type="text" name="von" id="von" placeholder="von" value="1386287940" />
		<input type="text" name="bis" id="bis" placeholder="bis" value="1386354196" />
		<input type="button" id="getCamBtn" onclick="getCam()" value="get!" />

		<button type="button" id="myClickBtn" onclick="clickToStore()">go!</button>
		<button type="button" id="mySearchBtn" onclick="clickToFind('bbbbbbaa@aaarrrr.de')">lookup</button>

</body>
</html>